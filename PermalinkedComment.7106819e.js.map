{"version":3,"sources":["webpack:///PermalinkedComment.7106819e.js","webpack:///./~/hoist-non-react-statics/index.js","webpack:///./~/react-router/lib/withRouter.js","webpack:///./src/PermalinkedComment.js"],"names":["webpackJsonp","hYij","module","exports","REACT_STATICS","childContextTypes","contextTypes","defaultProps","displayName","getDefaultProps","mixins","propTypes","type","KNOWN_STATICS","name","length","prototype","caller","arguments","arity","isGetOwnPropertySymbolsAvailable","Object","getOwnPropertySymbols","targetComponent","sourceComponent","customStatics","keys","getOwnPropertyNames","concat","i","error","XL6o","__webpack_require__","_interopRequireDefault","obj","__esModule","default","getDisplayName","WrappedComponent","withRouter","options","withRef","WithRouter","_react2","createClass","router","_PropTypes","routerShape","getWrappedInstance","_invariant2","this","wrappedInstance","render","_this","props","context","_extends","ref","c","createElement","_hoistNonReactStatics2","assign","target","source","key","hasOwnProperty","call","_invariant","_react","_hoistNonReactStatics","AcQZ","React","ReactFireMixin","CommentThreadStore","HNService","HNServiceRest","SettingsStore","UpdatesStore","Comment","CommentMixin","cx","setTitle","PermalinkedComment","level","loadingSpinner","getInitialState","comment","getComment","params","id","parent","op","componentWillMount","offlineMode","itemRef","then","res","json","snapshot","replaceState","bind","bindAsObject","state","commentLoaded","componentWillReceiveProps","nextProps","setState","unbind","componentWillUpdate","nextState","deleted","replace","threadStore","itemId","handleCommentsChanged","fetchAncestors","title","by","payload","forceUpdate","renderError","className","renderCommentLoading","renderCommentDeleted","Comment--dead","dead","renderCommentMeta","showDead","renderCommentText","replyLink","kids","map","index"],"mappings":"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","file":"PermalinkedComment.7106819e.js","sourcesContent":["webpackJsonp([1,5,6],{\n\n/***/ \"hYij\":\n/***/ function(module, exports) {\n\n\t/**\n\t * Copyright 2015, Yahoo! Inc.\n\t * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n\t */\n\t'use strict';\n\t\n\tvar REACT_STATICS = {\n\t    childContextTypes: true,\n\t    contextTypes: true,\n\t    defaultProps: true,\n\t    displayName: true,\n\t    getDefaultProps: true,\n\t    mixins: true,\n\t    propTypes: true,\n\t    type: true\n\t};\n\t\n\tvar KNOWN_STATICS = {\n\t    name: true,\n\t    length: true,\n\t    prototype: true,\n\t    caller: true,\n\t    arguments: true,\n\t    arity: true\n\t};\n\t\n\tvar isGetOwnPropertySymbolsAvailable = typeof Object.getOwnPropertySymbols === 'function';\n\t\n\tmodule.exports = function hoistNonReactStatics(targetComponent, sourceComponent, customStatics) {\n\t    if (typeof sourceComponent !== 'string') { // don't hoist over string (html) components\n\t        var keys = Object.getOwnPropertyNames(sourceComponent);\n\t\n\t        /* istanbul ignore else */\n\t        if (isGetOwnPropertySymbolsAvailable) {\n\t            keys = keys.concat(Object.getOwnPropertySymbols(sourceComponent));\n\t        }\n\t\n\t        for (var i = 0; i < keys.length; ++i) {\n\t            if (!REACT_STATICS[keys[i]] && !KNOWN_STATICS[keys[i]] && (!customStatics || !customStatics[keys[i]])) {\n\t                try {\n\t                    targetComponent[keys[i]] = sourceComponent[keys[i]];\n\t                } catch (error) {\n\t\n\t                }\n\t            }\n\t        }\n\t    }\n\t\n\t    return targetComponent;\n\t};\n\n\n/***/ },\n\n/***/ \"XL6o\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\texports.default = withRouter;\n\t\n\tvar _invariant = __webpack_require__(\"crWv\");\n\t\n\tvar _invariant2 = _interopRequireDefault(_invariant);\n\t\n\tvar _react = __webpack_require__(\"U7vG\");\n\t\n\tvar _react2 = _interopRequireDefault(_react);\n\t\n\tvar _hoistNonReactStatics = __webpack_require__(\"hYij\");\n\t\n\tvar _hoistNonReactStatics2 = _interopRequireDefault(_hoistNonReactStatics);\n\t\n\tvar _PropTypes = __webpack_require__(\"8xmk\");\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction getDisplayName(WrappedComponent) {\n\t  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n\t}\n\t\n\tfunction withRouter(WrappedComponent, options) {\n\t  var withRef = options && options.withRef;\n\t\n\t  var WithRouter = _react2.default.createClass({\n\t    displayName: 'WithRouter',\n\t\n\t    contextTypes: { router: _PropTypes.routerShape },\n\t    propTypes: { router: _PropTypes.routerShape },\n\t\n\t    getWrappedInstance: function getWrappedInstance() {\n\t      !withRef ?  false ? (0, _invariant2.default)(false, 'To access the wrapped instance, you need to specify ' + '`{ withRef: true }` as the second argument of the withRouter() call.') : (0, _invariant2.default)(false) : void 0;\n\t\n\t      return this.wrappedInstance;\n\t    },\n\t    render: function render() {\n\t      var _this = this;\n\t\n\t      var router = this.props.router || this.context.router;\n\t      var props = _extends({}, this.props, { router: router });\n\t\n\t      if (withRef) {\n\t        props.ref = function (c) {\n\t          _this.wrappedInstance = c;\n\t        };\n\t      }\n\t\n\t      return _react2.default.createElement(WrappedComponent, props);\n\t    }\n\t  });\n\t\n\t  WithRouter.displayName = 'withRouter(' + getDisplayName(WrappedComponent) + ')';\n\t  WithRouter.WrappedComponent = WrappedComponent;\n\t\n\t  return (0, _hoistNonReactStatics2.default)(WithRouter, WrappedComponent);\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n\n/***/ \"AcQZ\":\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(\"U7vG\");\n\tvar ReactFireMixin = __webpack_require__(\"/hDg\");\n\tvar withRouter = __webpack_require__(\"XL6o\");\n\t\n\tvar CommentThreadStore = __webpack_require__(\"Hwo6\");\n\tvar HNService = __webpack_require__(\"VIGu\");\n\tvar HNServiceRest = __webpack_require__(\"uaYK\");\n\tvar SettingsStore = __webpack_require__(\"NPdQ\");\n\tvar UpdatesStore = __webpack_require__(\"fsMb\");\n\t\n\tvar Comment = __webpack_require__(\"4fZb\");\n\tvar CommentMixin = __webpack_require__(\"bFfS\");\n\t\n\tvar cx = __webpack_require__(\"H9Jo\");\n\tvar _setTitle = __webpack_require__(\"SIDF\");\n\t\n\tvar PermalinkedComment = React.createClass({\n\t  displayName: 'PermalinkedComment',\n\t\n\t  mixins: [CommentMixin, ReactFireMixin],\n\t\n\t  getDefaultProps: function getDefaultProps() {\n\t    return {\n\t      level: 0,\n\t      loadingSpinner: true\n\t    };\n\t  },\n\t  getInitialState: function getInitialState() {\n\t    return {\n\t      comment: UpdatesStore.getComment(this.props.params.id) || {},\n\t      parent: { type: 'comment' },\n\t      op: {}\n\t    };\n\t  },\n\t  componentWillMount: function componentWillMount() {\n\t    if (SettingsStore.offlineMode) {\n\t      HNServiceRest.itemRef(this.props.params.id).then(function (res) {\n\t        return res.json();\n\t      }).then(function (snapshot) {\n\t        this.replaceState({ comment: snapshot });\n\t      }.bind(this));\n\t    } else {\n\t      this.bindAsObject(HNService.itemRef(this.props.params.id), 'comment');\n\t    }\n\t    if (this.state.comment.id) {\n\t      this.commentLoaded(this.state.comment);\n\t    }\n\t  },\n\t  componentWillReceiveProps: function componentWillReceiveProps(nextProps) {\n\t    if (nextProps.params.id !== this.props.params.id) {\n\t      var comment = UpdatesStore.getComment(nextProps.params.id);\n\t      if (comment) {\n\t        this.commentLoaded(comment);\n\t        this.setState({ comment: comment });\n\t      }\n\t      this.unbind('comment');\n\t      this.bindAsObject(HNService.itemRef(nextProps.params.id), 'comment');\n\t    }\n\t  },\n\t  componentWillUpdate: function componentWillUpdate(nextProps, nextState) {\n\t    if (!nextState.comment) {\n\t      return;\n\t    }\n\t\n\t    if (this.state.comment.id !== nextState.comment.id) {\n\t      if (!nextState.comment.deleted) {\n\t        // Redirect to the appropriate route if a Comment \"parent\" link had a\n\t        // non-comment item id.\n\t        if (nextState.comment.type !== 'comment') {\n\t          this.props.router.replace('/' + nextState.comment.type + '/' + nextState.comment.id);\n\t          return;\n\t        }\n\t      }\n\t      if (!this.threadStore || this.threadStore.itemId !== nextState.comment.id) {\n\t        this.commentLoaded(nextState.comment);\n\t      }\n\t    }\n\t  },\n\t  commentLoaded: function commentLoaded(comment) {\n\t    this.setTitle(comment);\n\t    if (!comment.deleted) {\n\t      this.threadStore = new CommentThreadStore(comment, this.handleCommentsChanged);\n\t      this.fetchAncestors(comment);\n\t    }\n\t  },\n\t  setTitle: function setTitle(comment) {\n\t    if (comment.deleted) {\n\t      return _setTitle('Deleted comment');\n\t    }\n\t    var title = 'Comment by ' + comment.by;\n\t    if (this.state.op.id) {\n\t      title += ' | ' + this.state.op.title;\n\t    }\n\t    _setTitle(title);\n\t  },\n\t  handleCommentsChanged: function handleCommentsChanged(payload) {\n\t    // We're only interested in re-rendering to update collapsed display\n\t    if (payload.type === 'collapse') {\n\t      this.forceUpdate();\n\t    }\n\t  },\n\t  render: function render() {\n\t    var comment = this.state.comment;\n\t    if (!comment) {\n\t      return this.renderError(comment, {\n\t        id: this.props.params.id,\n\t        className: 'Comment Comment--level0 Comment--error'\n\t      });\n\t    }\n\t    // Render a placeholder while we're waiting for the comment to load\n\t    if (!comment.id) {\n\t      return this.renderCommentLoading(comment);\n\t    }\n\t    // Render a link to HN for deleted comments\n\t    if (comment.deleted) {\n\t      return this.renderCommentDeleted(comment, {\n\t        className: 'Comment Comment--level0 Comment--deleted'\n\t      });\n\t    }\n\t    // XXX Don't render anything if we're replacing the route after loading a non-comment\n\t    if (comment.type !== 'comment') {\n\t      return null;\n\t    }\n\t\n\t    var className = cx('PermalinkedComment Comment Comment--level0', { 'Comment--dead': comment.dead });\n\t    var threadStore = this.threadStore;\n\t\n\t    return React.createElement(\n\t      'div',\n\t      { className: className },\n\t      React.createElement(\n\t        'div',\n\t        { className: 'Comment__content' },\n\t        this.renderCommentMeta(comment, {\n\t          parent: !!this.state.parent.id && !!this.state.op.id && comment.parent !== this.state.op.id,\n\t          op: !!this.state.op.id\n\t        }),\n\t        (!comment.dead || SettingsStore.showDead) && this.renderCommentText(comment, { replyLink: true })\n\t      ),\n\t      comment.kids && React.createElement(\n\t        'div',\n\t        { className: 'Comment__kids' },\n\t        comment.kids.map(function (id, index) {\n\t          return React.createElement(Comment, { key: id, id: id,\n\t            level: 0,\n\t            loadingSpinner: index === 0,\n\t            threadStore: threadStore\n\t          });\n\t        })\n\t      )\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = withRouter(PermalinkedComment);\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** PermalinkedComment.7106819e.js\n **/","/**\n * Copyright 2015, Yahoo! Inc.\n * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n */\n'use strict';\n\nvar REACT_STATICS = {\n    childContextTypes: true,\n    contextTypes: true,\n    defaultProps: true,\n    displayName: true,\n    getDefaultProps: true,\n    mixins: true,\n    propTypes: true,\n    type: true\n};\n\nvar KNOWN_STATICS = {\n    name: true,\n    length: true,\n    prototype: true,\n    caller: true,\n    arguments: true,\n    arity: true\n};\n\nvar isGetOwnPropertySymbolsAvailable = typeof Object.getOwnPropertySymbols === 'function';\n\nmodule.exports = function hoistNonReactStatics(targetComponent, sourceComponent, customStatics) {\n    if (typeof sourceComponent !== 'string') { // don't hoist over string (html) components\n        var keys = Object.getOwnPropertyNames(sourceComponent);\n\n        /* istanbul ignore else */\n        if (isGetOwnPropertySymbolsAvailable) {\n            keys = keys.concat(Object.getOwnPropertySymbols(sourceComponent));\n        }\n\n        for (var i = 0; i < keys.length; ++i) {\n            if (!REACT_STATICS[keys[i]] && !KNOWN_STATICS[keys[i]] && (!customStatics || !customStatics[keys[i]])) {\n                try {\n                    targetComponent[keys[i]] = sourceComponent[keys[i]];\n                } catch (error) {\n\n                }\n            }\n        }\n    }\n\n    return targetComponent;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/hoist-non-react-statics/index.js\n ** module id = hYij\n ** module chunks = 1\n **/","'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = withRouter;\n\nvar _invariant = require('invariant');\n\nvar _invariant2 = _interopRequireDefault(_invariant);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _hoistNonReactStatics = require('hoist-non-react-statics');\n\nvar _hoistNonReactStatics2 = _interopRequireDefault(_hoistNonReactStatics);\n\nvar _PropTypes = require('./PropTypes');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n\nfunction withRouter(WrappedComponent, options) {\n  var withRef = options && options.withRef;\n\n  var WithRouter = _react2.default.createClass({\n    displayName: 'WithRouter',\n\n    contextTypes: { router: _PropTypes.routerShape },\n    propTypes: { router: _PropTypes.routerShape },\n\n    getWrappedInstance: function getWrappedInstance() {\n      !withRef ? process.env.NODE_ENV !== 'production' ? (0, _invariant2.default)(false, 'To access the wrapped instance, you need to specify ' + '`{ withRef: true }` as the second argument of the withRouter() call.') : (0, _invariant2.default)(false) : void 0;\n\n      return this.wrappedInstance;\n    },\n    render: function render() {\n      var _this = this;\n\n      var router = this.props.router || this.context.router;\n      var props = _extends({}, this.props, { router: router });\n\n      if (withRef) {\n        props.ref = function (c) {\n          _this.wrappedInstance = c;\n        };\n      }\n\n      return _react2.default.createElement(WrappedComponent, props);\n    }\n  });\n\n  WithRouter.displayName = 'withRouter(' + getDisplayName(WrappedComponent) + ')';\n  WithRouter.WrappedComponent = WrappedComponent;\n\n  return (0, _hoistNonReactStatics2.default)(WithRouter, WrappedComponent);\n}\nmodule.exports = exports['default'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/react-router/lib/withRouter.js\n ** module id = XL6o\n ** module chunks = 1\n **/","var React = require('react')\nvar ReactFireMixin = require('reactfire')\nvar withRouter = require('react-router/lib/withRouter')\n\nvar CommentThreadStore = require('./stores/CommentThreadStore')\nvar HNService = require('./services/HNService')\nvar HNServiceRest = require('./services/HNServiceRest')\nvar SettingsStore = require('./stores/SettingsStore')\nvar UpdatesStore = require('./stores/UpdatesStore')\n\nvar Comment = require('./Comment')\nvar CommentMixin = require('./mixins/CommentMixin')\n\nvar cx = require('./utils/buildClassName')\nvar setTitle = require('./utils/setTitle')\n\nvar PermalinkedComment = React.createClass({\n  mixins: [CommentMixin, ReactFireMixin],\n\n  getDefaultProps() {\n    return {\n      level: 0,\n      loadingSpinner: true\n    }\n  },\n\n  getInitialState() {\n    return {\n      comment: UpdatesStore.getComment(this.props.params.id) || {},\n      parent: {type: 'comment'},\n      op: {}\n    }\n  },\n\n  componentWillMount() {\n    if (SettingsStore.offlineMode) {\n      HNServiceRest.itemRef(this.props.params.id).then(function(res) {\n        return res.json()\n      }).then(function(snapshot) {\n        this.replaceState({ comment: snapshot })\n      }.bind(this))\n    }\n    else {\n      this.bindAsObject(HNService.itemRef(this.props.params.id), 'comment')\n    }\n    if (this.state.comment.id) {\n      this.commentLoaded(this.state.comment)\n    }\n  },\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.params.id !== this.props.params.id) {\n      var comment = UpdatesStore.getComment(nextProps.params.id)\n      if (comment) {\n        this.commentLoaded(comment)\n        this.setState({comment: comment})\n      }\n      this.unbind('comment')\n      this.bindAsObject(HNService.itemRef(nextProps.params.id), 'comment')\n    }\n  },\n\n  componentWillUpdate(nextProps, nextState) {\n    if (!nextState.comment) {\n      return\n    }\n\n    if (this.state.comment.id !== nextState.comment.id) {\n      if (!nextState.comment.deleted) {\n        // Redirect to the appropriate route if a Comment \"parent\" link had a\n        // non-comment item id.\n        if (nextState.comment.type !== 'comment') {\n          this.props.router.replace(`/${nextState.comment.type}/${nextState.comment.id}`)\n          return\n        }\n      }\n      if (!this.threadStore || this.threadStore.itemId !== nextState.comment.id) {\n        this.commentLoaded(nextState.comment)\n      }\n    }\n  },\n\n  commentLoaded(comment) {\n    this.setTitle(comment)\n    if (!comment.deleted) {\n      this.threadStore = new CommentThreadStore(comment, this.handleCommentsChanged)\n      this.fetchAncestors(comment)\n    }\n  },\n\n  setTitle(comment) {\n    if (comment.deleted) {\n      return setTitle('Deleted comment')\n    }\n    var title = 'Comment by ' + comment.by\n    if (this.state.op.id) {\n      title += ' | ' + this.state.op.title\n    }\n    setTitle(title)\n  },\n\n  handleCommentsChanged(payload) {\n    // We're only interested in re-rendering to update collapsed display\n    if (payload.type === 'collapse') {\n      this.forceUpdate()\n    }\n  },\n\n  render() {\n    var comment = this.state.comment\n    if (!comment) {\n      return this.renderError(comment, {\n        id: this.props.params.id,\n        className: 'Comment Comment--level0 Comment--error'\n      })\n    }\n    // Render a placeholder while we're waiting for the comment to load\n    if (!comment.id) { return this.renderCommentLoading(comment) }\n    // Render a link to HN for deleted comments\n    if (comment.deleted) {\n      return this.renderCommentDeleted(comment, {\n        className: 'Comment Comment--level0 Comment--deleted'\n      })\n    }\n    // XXX Don't render anything if we're replacing the route after loading a non-comment\n    if (comment.type !== 'comment') { return null }\n\n    var className = cx('PermalinkedComment Comment Comment--level0', {'Comment--dead': comment.dead})\n    var threadStore = this.threadStore\n\n    return <div className={className}>\n      <div className=\"Comment__content\">\n        {this.renderCommentMeta(comment, {\n          parent: !!this.state.parent.id && !!this.state.op.id && comment.parent !== this.state.op.id,\n          op: !!this.state.op.id\n        })}\n        {(!comment.dead || SettingsStore.showDead) && this.renderCommentText(comment, {replyLink: true})}\n      </div>\n      {comment.kids && <div className=\"Comment__kids\">\n        {comment.kids.map(function(id, index) {\n          return <Comment key={id} id={id}\n            level={0}\n            loadingSpinner={index === 0}\n            threadStore={threadStore}\n          />\n        })}\n      </div>}\n    </div>\n  }\n})\n\nmodule.exports = withRouter(PermalinkedComment)\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/PermalinkedComment.js\n **/"],"sourceRoot":""}